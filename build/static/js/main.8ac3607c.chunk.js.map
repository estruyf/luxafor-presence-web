{"version":3,"sources":["models/Availability.ts","models/TimeType.ts","constants/auth-utils.tsx","components/Authenticator/AuthProvider.tsx","services/Luxafor.tsx","services/PresenceContext.ts","components/Header/Header.tsx","components/Footer/Footer.tsx","components/LuxaforPresence/LuxaforPresence.tsx","helpers/TimeHelpers.ts","components/App/App.tsx","components/App/index.ts","models/index.ts","serviceWorker.ts","index.tsx"],"names":["Availability","TimeType","fetchMsGraph","url","accessToken","a","fetch","headers","Authorization","response","json","isIE","ua","window","navigator","userAgent","msie","indexOf","msie11","GRAPH_ENDPOINTS","GRAPH_REQUESTS","LOGIN","scopes","PRESENCE","msalApp","UserAgentApplication","auth","clientId","authority","validateAuthority","postLogoutRedirectUri","navigateToLoginRequestUrl","cache","cacheLocation","storeAuthStateInCookie","system","navigateFrameWait","logger","error","console","errorPii","info","log","infoPii","verbose","verbosePii","warning","warn","warningPii","useRedirectFlow","Luxafor","deviceId","presence","color","Available","AvailableIdle","Away","BeRightBack","Busy","BusyIdle","DoNotDisturb","Offline","PresenceUnknown","body","userId","actionFields","custom_color","method","JSON","stringify","data","ok","name","localStorage","getItem","value","setItem","defaultContextValues","getDeviceSetting","refreshNr","startTime","endTime","PresenceContext","React","createContext","Header","props","deviceChange","newIdInput","target","updateDeviceId","refreshChange","updateRefresh","parseInt","this","account","onSignIn","onSignOut","updateTime","context","className","Container","fixed","Grid","container","style","flexGrow","spacing","item","xs","Button","onClick","variant","userName","TextField","label","required","onChange","type","inputProps","min","max","step","pattern","e","StartTime","EndTime","Component","contextType","Footer","href","title","LuxaforPresence","Consumer","backgroundColor","splitHours","time","includes","daySplit","split","hour","minutes","C","theme","createMuiTheme","palette","App","refreshTimer","setState","prevState","setDeviceSetting","startPresenceCheck","acquireToken","token","message","availability","setColor","state","startDataFetching","prevProps","stopPresenceCheck","startTimeSplit","endTimeSplit","crntDate","Date","statusMsg","statusColor","getHours","getMinutes","doCheck","setTimeout","clearTimeout","Provider","ThemeProvider","AppWithAuth","authCalled","handleRedirectCallback","errorMessage","getAccount","request","redirect","acquireTokenSilent","errorCode","length","acquireTokenRedirect","acquireTokenPopup","loginRedirect","loginPopup","catch","loginResponse","logout","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.8ac3607c.chunk.js","sourcesContent":["export enum Availability {\n  Available = \"Available\", \n  AvailableIdle = \"AvailableIdle\", \n  Away = \"Away\", \n  BeRightBack = \"BeRightBack\", \n  Busy = \"Busy\",\n  BusyIdle = \"BusyIdle\", \n  DoNotDisturb = \"DoNotDisturb\", \n  Offline = \"Offline\",\n  PresenceUnknown = \"PresenceUnknown\"\n}","\n\nexport enum TimeType {\n  StartTime = 1,\n  EndTime\n}","import { UserAgentApplication, Configuration } from \"msal\";\n\nexport const requiresInteraction = (errorMessage: any) => {\n  if (!errorMessage || !errorMessage.length) {\n    return false;\n  }\n  \n  return (\n    errorMessage.indexOf(\"consent_required\") > -1 ||\n    errorMessage.indexOf(\"interaction_required\") > -1 ||\n    errorMessage.indexOf(\"login_required\") > -1\n  );\n};\n  \nexport const fetchMsGraph = async (url: string, accessToken: string) => {\n  const response = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${accessToken}`\n    }\n  });\n  \n  return response.json();\n};\n  \nexport const isIE = (): boolean => {\n  const ua = window.navigator.userAgent;\n  const msie = ua.indexOf(\"MSIE \") > -1;\n  const msie11 = ua.indexOf(\"Trident/\") > -1;\n  \n  // If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\n  // const isEdge = ua.indexOf(\"Edge/\") > -1;\n  \n  return msie || msie11;\n};\n  \nexport const GRAPH_SCOPES = {\n  OPENID: \"openid\",\n  PROFILE: \"profile\",\n  USER_READ: \"User.Read\",\n  PRESENCE_READ: \"Presence.Read\"\n};\n  \nexport const GRAPH_ENDPOINTS = {\n  ME: \"https://graph.microsoft.com/v1.0/me\",\n  PRESENCE: \"https://graph.microsoft.com/beta/me/presence\"\n};\n  \nexport const GRAPH_REQUESTS = {\n  LOGIN: {\n    scopes: [\n      GRAPH_SCOPES.OPENID,\n      GRAPH_SCOPES.PROFILE,\n      GRAPH_SCOPES.USER_READ\n    ]\n  },\n  PRESENCE: {\n    scopes: [GRAPH_SCOPES.PRESENCE_READ]\n  }\n};\n  \nexport const msalApp = new UserAgentApplication({\n  auth: {\n    clientId: \"66204339-daf1-40fa-aa31-57342272edce\",\n    authority: \"https://login.microsoftonline.com/common\",\n    validateAuthority: true,\n    postLogoutRedirectUri: \"https://luxafor-presence.azurewebsites.net\",\n    navigateToLoginRequestUrl: false\n  },\n  cache: {\n    cacheLocation: \"sessionStorage\",\n    storeAuthStateInCookie: isIE()\n  },\n  system: {\n    navigateFrameWait: 0,\n    logger: {\n      error: console.error,\n      errorPii: console.error,\n      info: console.log,\n      infoPii: console.log,\n      verbose: console.log,\n      verbosePii: console.log,\n      warning: console.warn,\n      warningPii: console.warn\n    }\n  }\n} as Configuration);","import React, { Component } from \"react\";\nimport {\n  msalApp,\n  requiresInteraction,\n  fetchMsGraph,\n  isIE,\n  GRAPH_ENDPOINTS,\n  GRAPH_REQUESTS\n} from \"../../constants\";\nimport { Presence } from \"../../models\";\nimport { AuthProviderProps, AuthProviderState } from '.';\n\n// If you support IE, our recommendation is that you sign-in using Redirect APIs\nconst useRedirectFlow = isIE();\n// const useRedirectFlow = true;\n\nexport default (C: any) => class AuthProvider extends Component<AuthProviderProps, AuthProviderState> {\n  private authCalled: boolean = false;\n  \n  constructor(props: AuthProviderProps) {\n    super(props);\n    \n    this.state = {\n      account: null,\n      error: null,\n      presence: null\n    };\n  }\n\n  /**\n   * componentDidMount lifecycle hook\n   */\n  public async componentDidMount() {\n    msalApp.handleRedirectCallback((error: any) => {\n      if (error) {\n        const errorMessage = error.errorMessage ? error.errorMessage : \"Unable to acquire access token.\";\n        // setState works as long as navigateToLoginRequestUrl: false\n        this.setState({\n          error: errorMessage\n        });\n      }\n    });\n    \n    const account = msalApp.getAccount();\n    \n    this.setState({\n      account\n    });\n  }\n  \n  /**\n   * Acquire token\n   * \n   * @param request \n   * @param redirect \n   */\n  public async acquireToken(request: any, redirect?: boolean) {\n    try {\n      return await msalApp.acquireTokenSilent(request);\n    } catch (error) {\n      // Call acquireTokenPopup (popup window) in case of acquireTokenSilent failure\n      // due to consent or interaction required ONLY\n      if (requiresInteraction(error.errorCode)) {\n        return redirect ? msalApp.acquireTokenRedirect(request) : msalApp.acquireTokenPopup(request);\n      } else {\n        console.error('Non-interactive error:', error.errorCode)\n      }\n    }\n  }\n  \n  /**\n   * Sign in the user\n   * \n   * @param redirect \n   */\n  public async onSignIn(redirect: boolean) {\n    if (this.authCalled) {\n      return;\n    }\n\n    this.authCalled = true;\n\n    if (redirect) {\n      return msalApp.loginRedirect(GRAPH_REQUESTS.PRESENCE);\n    }\n    \n    const loginResponse = await msalApp.loginPopup(GRAPH_REQUESTS.PRESENCE).catch(error => {\n      this.setState({\n        error: error.message\n      });\n    });\n\n    if (loginResponse) {\n      this.setState({\n        account: loginResponse.account,\n        error: null\n      });\n    }\n  }\n     \n  /**\n   * Sign out the user\n   */\n  public onSignOut() {\n    msalApp.logout();\n  }\n\n  \n\n  public getAccessToken(): string {\n    return \"\";\n  }\n      \n  /**\n   * Render the authentication component as a wrapper for the APP\n   */\n  render() {\n    return (\n      <C {...this.props}\n         account={this.state.account}\n         error={this.state.error}\n         presence={this.state.presence}\n         onSignIn={() => this.onSignIn(useRedirectFlow)}\n         onSignOut={() => this.onSignOut()}\n         acquireToken={this.acquireToken} />\n    );\n  }\n};","import { Availability } from \"../models\";\n\nexport const DEFAULT_COLOR = \"000000\";\nexport const API_URL = \"/api/setColor\";\n\nexport const KEY_DEVICE_ID = \"Device:ID\";\nexport const KEY_REFRESH_NR = \"RefreshNr\";\nexport const KEY_START_TIME = \"StartTime\";\nexport const KEY_END_TIME = \"EndTime\";\n\nexport class Luxafor {\n\n  public static async setColor(deviceId: string, presence: string): Promise<string> {\n    let color: string = DEFAULT_COLOR;\n\n    if (!deviceId || !presence) {\n      return color;\n    }\n    \n    switch(presence) {\n      case Availability.Available:\n      case Availability.AvailableIdle:\n        color = \"008000\";\n        break;\n      case Availability.Away:\n      case Availability.BeRightBack:\n        color = \"B2B200\";\n        break;\n      case Availability.Busy:\n      case Availability.BusyIdle:\n      case Availability.DoNotDisturb:\n        color = \"990000\";\n        break;\n      case Availability.Offline:\n      case Availability.PresenceUnknown:\n      default:\n        color = DEFAULT_COLOR;\n        break;\n    }\n\n    const body = {\n      userId: deviceId,\n      actionFields: {\n        color: \"custom\",\n        custom_color: color\n      }\n    };\n\n    const data = await fetch(API_URL, {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\",\n        \"accept\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    });\n\n    if (data && data.ok) {\n      return color;\n    } else {\n      return DEFAULT_COLOR;\n    }\n  }\n\n  public static getDeviceSetting<T>(name: string): T | string {\n    if (localStorage) {\n      return localStorage.getItem(`Luxafor:${name}`) || \"\";\n    }\n    return \"\";\n  }\n\n  public static setDeviceSetting(name: string, value: any): void {\n    if (localStorage) {\n      localStorage.setItem(`Luxafor:${name}`, value);\n    }\n  }\n}","import React, { useState } from 'react';\nimport { Luxafor, KEY_DEVICE_ID, KEY_REFRESH_NR, KEY_START_TIME, KEY_END_TIME, DEFAULT_COLOR } from \".\";\nimport { AppState } from \"../components/App\";\n\nexport const defaultContextValues = {\n  deviceId: Luxafor.getDeviceSetting<string>(KEY_DEVICE_ID),\n  refreshNr: Luxafor.getDeviceSetting<number>(KEY_REFRESH_NR) as number || 2,\n  startTime: Luxafor.getDeviceSetting<string>(KEY_START_TIME),\n  endTime: Luxafor.getDeviceSetting<string>(KEY_END_TIME),\n  presence: \"\",\n  color: DEFAULT_COLOR\n} as AppState;\n\nexport const PresenceContext = React.createContext(defaultContextValues);","import React, { useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Container from '@material-ui/core/Container';\nimport Settings from '@material-ui/icons/Settings';\nimport Grid from '@material-ui/core/Grid';\nimport { Account } from \"msal\";\nimport './Header.css';\nimport { PresenceContext } from '../../services/PresenceContext';\nimport { AppState } from '../App';\nimport { TimeType } from '../../models';\n\nexport interface HeaderProps {\n  account: Account | null;\n\n  onSignIn: () => void;\n  onSignOut: () => void;\n  updateRefresh: (refreshNr: number) => void;\n  updateDeviceId: (deviceId: string) => void;\n  updateTime: (name: TimeType, time: string) => void;\n}\n\nexport interface HeaderState {\n  deviceId: string;\n}\n\nclass Header extends React.Component<HeaderProps, HeaderState> {\n  \n  constructor(props: HeaderProps) {\n    super(props);\n  }\n\n  private deviceChange = (newIdInput: React.ChangeEvent<HTMLInputElement>) => {\n    if (newIdInput && newIdInput.target && newIdInput.target.value) {\n      this.props.updateDeviceId(newIdInput.target.value);\n    }\n  };\n\n  private refreshChange = (newIdInput: React.ChangeEvent<HTMLInputElement>) => {\n    if (newIdInput && newIdInput.target && newIdInput.target.value) {\n      this.props.updateRefresh(parseInt(newIdInput.target.value));\n    }\n  };\n\n  public render(): React.ReactElement<HeaderProps> {\n    const { account, onSignIn, onSignOut, updateTime } = this.props;\n    const { deviceId, refreshNr, startTime, endTime } = this.context as AppState;\n\n    return (\n      <header className=\"app__header\">\n        {\n        !account ? (\n          <Button onClick={onSignIn} variant=\"outlined\" color=\"primary\">Sign In</Button>\n        ) : (\n          <Container fixed>\n            <Grid container style={{flexGrow:1}} spacing={1}>\n              <Grid item xs={12}>\n                <Button onClick={onSignOut} variant=\"outlined\" color=\"secondary\">Sign Out: {account.userName}</Button>\n              </Grid>\n              <Grid item xs={3}>\n                <TextField label=\"Device ID\" \n                           variant=\"filled\" \n                           required\n                           value={deviceId}\n                           onChange={this.deviceChange} />\n              </Grid>\n              <Grid item xs={3}>\n                <TextField label=\"Refresh time (minutes)\" \n                           variant=\"filled\"\n                           value={refreshNr ? refreshNr : \"\"}\n                           type=\"number\"\n                           inputProps={{ min: \"1\", max: \"10\", step: \"1\" }}\n                           onChange={this.refreshChange} />\n              </Grid>\n              <Grid item xs={3}>\n                <TextField label=\"Start time\" \n                           variant=\"filled\"\n                           value={startTime}\n                           inputProps={{\n                            pattern: \"([01]?[0-9]|2[0-3]):[0-5][0-9]\"\n                           }}\n                           onChange={e => updateTime(TimeType.StartTime, e.target.value)} />\n              </Grid>\n              <Grid item xs={3}>\n                <TextField label=\"End time\" \n                           variant=\"filled\"\n                           value={endTime}\n                           inputProps={{\n                            pattern: \"([01]?[0-9]|2[0-3]):[0-5][0-9]\"\n                           }}\n                           onChange={e => updateTime(TimeType.EndTime, e.target.value)} />\n              </Grid>\n            </Grid>\n          </Container>\n        )}\n      </header>\n    );\n  }\n}\n\nHeader.contextType = PresenceContext;\n\nexport default Header;","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport { Account } from \"msal\";\nimport './Footer.css';\nimport GitHub from '@material-ui/icons/GitHub';\nimport Copyright from '@material-ui/icons/Copyright';\n\nexport interface FooterProps {}\n\nexport const Footer = (props: FooterProps) => {\n  \n  return (\n    <footer className=\"app__footer\">\n      <Button href=\"https://www.eliostruyf.com\" title=\"Go to the website of Elio Struyf\">Copyright <Copyright /> Elio Struyf - https://www.eliostruyf.com</Button> - <Button href=\"https://github.com/estruyf\" className=\"app__footer_github\"><GitHub /></Button>\n    </footer>\n  );\n};","import React from 'react';\nimport { Account } from \"msal\";\nimport './LuxaforPresence.css';\nimport { PresenceContext } from '../../services/PresenceContext';\nimport { Availability } from '../../models';\n\nexport const LuxaforPresence = () => {\n\n  \n  \n  return (\n    <PresenceContext.Consumer>\n      {\n        info => {\n          let color = `#282c34`;\n          switch (info.presence) {\n            case Availability.Available:\n            case Availability.AvailableIdle:\n              color = `#58BC82`;\n              break;\n            case Availability.Busy:\n            case Availability.BusyIdle:\n            case Availability.DoNotDisturb:\n              color = `#6F1A07`;\n              break;\n            case Availability.Away:\n            case Availability.BeRightBack:\n              color = `#F6AE2D`;\n              break;\n            default: \n              color = `#282c34`;\n              break;\n          }\n\n          return (\n            <main className=\"app__main\" style={{\n              backgroundColor: `#${color}`\n            }}>\n              <h1>Luxafor - Presence</h1>\n              {\n                info.presence && <h2>{info.presence}</h2>\n              }\n            </main>\n          );\n        }\n      }\n    </PresenceContext.Consumer>\n  );\n};","\nexport const splitHours = (time: string): { hour: number, minutes: number} | null => {\n  if (time && time.includes(\":\")) {\n    const daySplit = time.split(\":\");\n    return {\n      hour: parseInt(daySplit[0]),\n      minutes: parseInt(daySplit[1])\n    }\n  }\n\n  return null;\n}","import React from 'react';\nimport './App.css';\nimport AuthProvider from '../Authenticator/AuthProvider';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport Header from '../Header/Header';\nimport { Footer } from '../Footer';\nimport { AppProps, AppState } from '.';\nimport { Luxafor, KEY_REFRESH_NR, KEY_DEVICE_ID } from '../../services';\nimport { LuxaforPresence } from '../LuxaforPresence';\nimport { defaultContextValues, PresenceContext } from '../../services/PresenceContext';\nimport { TimeType, Presence, Availability } from '../../models';\nimport { GRAPH_REQUESTS, fetchMsGraph, GRAPH_ENDPOINTS } from '../../constants';\nimport { splitHours } from '../../helpers/TimeHelpers';\n\n/**\n * TODO:\n * - Override the presence status\n * - Change the colors\n * - Manual or automated work\n */\nconst theme = createMuiTheme({\n  palette: {\n    type: 'dark'\n  },\n});\n\nclass App extends React.Component<AppProps, AppState> {\n  private refreshTimer: any;\n  \n  constructor(props: AppProps) {\n    super(props);\n\n    this.state = {\n      ...defaultContextValues\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.account && this.state.deviceId && this.state.refreshNr) {\n      this.startDataFetching();\n    }\n  }\n\n  componentDidUpdate(prevProps: AppProps, prevState: AppState) {\n    if (prevState.refreshNr !== this.state.refreshNr ||\n        prevState.startTime !== this.state.startTime ||\n        prevState.endTime !== this.state.endTime) {\n      this.startDataFetching();\n    }\n\n    if (prevProps.account !== this.props.account && this.props.account) {\n      this.startDataFetching();\n    }\n\n    if (!this.props.account) {\n      this.stopPresenceCheck();\n    }\n  }\n\n  private updateDeviceId = (deviceId: string): void => {\n    this.setState((prevState: AppState) => {\n      const cloned = {...prevState};\n      cloned.deviceId = deviceId;\n      Luxafor.setDeviceSetting(KEY_DEVICE_ID, deviceId);\n      return {\n        ...prevState,\n        deviceId\n      };\n    });\n  };\n\n  private updateRefresh = (refreshNr: number): void => {\n    this.setState((prevState: AppState) => {\n      Luxafor.setDeviceSetting(KEY_REFRESH_NR, refreshNr);\n      return {\n        ...prevState,\n        refreshNr\n      };\n    });\n  };\n\n  private updateTime = (name: TimeType, time: string) => {\n    if (name && time) {\n      Luxafor.setDeviceSetting(TimeType[name], time);\n      if (name === TimeType.StartTime) {\n        this.setState({\n          startTime: time\n        });\n      } else {\n        this.setState({\n          endTime: time\n        });\n      }\n    }\n  };\n\n  /**\n   * Start fetching the data\n   */\n  private startDataFetching() {\n    const { deviceId, startTime, endTime, refreshNr } = this.state;\n\n    const startTimeSplit = splitHours(startTime);\n    const endTimeSplit = splitHours(endTime);\n    const crntDate = new Date();\n    let statusMsg: string | null = null;\n    let statusColor: string | null = null;\n\n    if (startTimeSplit && (crntDate.getHours() < startTimeSplit.hour || crntDate.getHours() === startTimeSplit.hour && crntDate.getMinutes() < startTimeSplit.minutes)) {\n      statusMsg = Availability.Offline;\n      statusColor = \"000000\";\n    }\n\n    if (endTimeSplit && (crntDate.getHours() > endTimeSplit.hour || crntDate.getHours() === endTimeSplit.hour && crntDate.getMinutes() > endTimeSplit.minutes)) {\n      statusMsg = Availability.Offline;\n      statusColor = \"000000\";\n    }\n\n    let doCheck = true;\n    if (statusMsg) {\n      // Only update if needed\n      if (statusMsg !== this.state.presence) {\n        Luxafor.setColor(deviceId, Availability.Offline);\n        this.setState({\n          presence: statusMsg as string,\n          color: statusColor as string\n        });\n      }\n      doCheck = false;\n    }\n\n    if (doCheck) {\n      this.startPresenceCheck();\n    }\n\n    if (refreshNr) {\n      this.refreshTimer = setTimeout(() => {\n        this.startDataFetching();\n      }, refreshNr * 60 * 1000);\n    }\n  }\n\n  /**\n   * Start checking the user its presence\n   */\n  private startPresenceCheck = async () => {\n    const { acquireToken } = this.props;\n\n    try {\n      let token;\n\n      try {\n        token = await acquireToken(GRAPH_REQUESTS.PRESENCE);\n      } catch (error) {\n        this.setState({\n          error: error.message\n        });\n        return;\n      }\n\n      if (token) {\n        const presence: Presence = await fetchMsGraph(GRAPH_ENDPOINTS.PRESENCE, token.accessToken);\n        if (presence && presence.availability) {\n          const color = await Luxafor.setColor(this.state.deviceId, presence.availability);\n          this.setState({\n            presence: presence.availability,\n            color\n          });\n        }\n      }\n    } catch (error) {\n      this.setState({\n        error: \"Unable to fetch Graph profile.\"\n      });\n    }\n  }\n\n  private stopPresenceCheck() {\n    if (this.refreshTimer) {\n      clearTimeout(this.refreshTimer);\n      this.refreshTimer = null;\n    }\n  }\n\n  public render(): React.ReactElement<AppProps> {\n    return (\n      <PresenceContext.Provider value={{\n        deviceId: this.state.deviceId,\n        refreshNr: this.state.refreshNr,\n        color: this.state.color,\n        endTime: this.state.endTime,\n        startTime: this.state.startTime,\n        presence: this.state.presence,\n        error: \"\"\n      }}>\n        <ThemeProvider theme={theme}>\n          <div className=\"app\">\n            <Header account={this.props.account}\n                    onSignIn={this.props.onSignIn} \n                    onSignOut={this.props.onSignOut}\n                    updateRefresh={this.updateRefresh}\n                    updateDeviceId={this.updateDeviceId}\n                    updateTime={this.updateTime} />\n  \n            <LuxaforPresence />\n\n            {\n              this.state.error && <p className=\"app__error\">{this.state.error}</p>\n            }\n  \n            <Footer />\n          </div>\n        </ThemeProvider>\n      </PresenceContext.Provider>\n    );\n  }\n}\n\nexport const AppWithAuth = AuthProvider(App);","export * from './App';\nexport * from './AppProps';\nexport * from './AppState';\n","export * from './Availability';\nexport * from './Presence';\nexport * from './TimeType';\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { AppWithAuth } from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<AppWithAuth />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}