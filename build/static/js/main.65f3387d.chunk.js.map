{"version":3,"sources":["models/Availability.ts","models/TimeType.ts","constants/auth-utils.tsx","components/Authenticator/AuthProvider.tsx","services/Luxafor.tsx","services/PresenceContext.ts","components/Header/Header.tsx","components/Footer/Footer.tsx","components/LuxaforPresence/LuxaforPresence.tsx","helpers/TimeHelpers.ts","components/App/App.tsx","components/App/index.ts","models/index.ts","serviceWorker.ts","index.tsx"],"names":["Availability","TimeType","fetchMsGraph","url","accessToken","a","fetch","headers","Authorization","response","json","isIE","ua","window","navigator","userAgent","msie","indexOf","msie11","GRAPH_ENDPOINTS","GRAPH_REQUESTS","LOGIN","scopes","PRESENCE","msalApp","UserAgentApplication","auth","clientId","authority","validateAuthority","postLogoutRedirectUri","navigateToLoginRequestUrl","cache","cacheLocation","storeAuthStateInCookie","system","navigateFrameWait","logger","error","console","errorPii","info","log","infoPii","verbose","verbosePii","warning","warn","warningPii","useRedirectFlow","Luxafor","deviceId","presence","color","Available","AvailableIdle","Away","BeRightBack","Busy","BusyIdle","DoNotDisturb","Offline","PresenceUnknown","body","userId","actionFields","custom_color","method","JSON","stringify","data","ok","name","localStorage","getItem","value","setItem","defaultContextValues","getDeviceSetting","refreshNr","startTime","endTime","overwrittenPresence","PresenceContext","React","createContext","Header","props","deviceChange","newIdInput","target","updateDeviceId","refreshChange","updateRefresh","parseInt","this","account","onSignIn","onSignOut","updateTime","context","classes","className","Container","fixed","Grid","container","style","flexGrow","spacing","item","xs","Button","onClick","variant","userName","sm","md","grid","TextField","label","required","onChange","type","inputProps","min","max","step","pattern","e","StartTime","EndTime","Component","contextType","withStyles","theme","marginBottom","width","Footer","href","title","LuxaforPresence","handleChange","event","overwritePresense","Consumer","backgroundColor","Select","Object","keys","map","key","MenuItem","splitHours","time","includes","daySplit","split","hour","minutes","C","createMuiTheme","palette","overrides","MuiSelect","select","fontSize","App","refreshTimer","setState","prevState","setDeviceSetting","startPresenceCheck","acquireToken","token","message","availability","setColor","state","stopPresenceCheck","startDataFetching","prevProps","startTimeSplit","endTimeSplit","crntDate","Date","statusMsg","statusColor","getHours","getMinutes","doCheck","setTimeout","clearTimeout","Provider","ThemeProvider","AppWithAuth","authCalled","handleRedirectCallback","errorMessage","getAccount","request","redirect","acquireTokenSilent","errorCode","length","acquireTokenRedirect","acquireTokenPopup","loginRedirect","loginPopup","catch","loginResponse","logout","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.65f3387d.chunk.js","sourcesContent":["export enum Availability {\n  Available = \"Available\", \n  AvailableIdle = \"AvailableIdle\", \n  Away = \"Away\", \n  BeRightBack = \"BeRightBack\", \n  Busy = \"Busy\",\n  BusyIdle = \"BusyIdle\", \n  DoNotDisturb = \"DoNotDisturb\", \n  Offline = \"Offline\",\n  PresenceUnknown = \"PresenceUnknown\"\n}","\n\nexport enum TimeType {\n  StartTime = 1,\n  EndTime\n}","import { UserAgentApplication, Configuration } from \"msal\";\n\nexport const requiresInteraction = (errorMessage: any) => {\n  if (!errorMessage || !errorMessage.length) {\n    return false;\n  }\n  \n  return (\n    errorMessage.indexOf(\"consent_required\") > -1 ||\n    errorMessage.indexOf(\"interaction_required\") > -1 ||\n    errorMessage.indexOf(\"login_required\") > -1\n  );\n};\n  \nexport const fetchMsGraph = async (url: string, accessToken: string) => {\n  const response = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${accessToken}`\n    }\n  });\n  \n  return response.json();\n};\n  \nexport const isIE = (): boolean => {\n  const ua = window.navigator.userAgent;\n  const msie = ua.indexOf(\"MSIE \") > -1;\n  const msie11 = ua.indexOf(\"Trident/\") > -1;\n  \n  // If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\n  // const isEdge = ua.indexOf(\"Edge/\") > -1;\n  \n  return msie || msie11;\n};\n  \nexport const GRAPH_SCOPES = {\n  OPENID: \"openid\",\n  PROFILE: \"profile\",\n  USER_READ: \"User.Read\",\n  PRESENCE_READ: \"Presence.Read\"\n};\n  \nexport const GRAPH_ENDPOINTS = {\n  ME: \"https://graph.microsoft.com/v1.0/me\",\n  PRESENCE: \"https://graph.microsoft.com/beta/me/presence\"\n};\n  \nexport const GRAPH_REQUESTS = {\n  LOGIN: {\n    scopes: [\n      GRAPH_SCOPES.OPENID,\n      GRAPH_SCOPES.PROFILE,\n      GRAPH_SCOPES.USER_READ\n    ]\n  },\n  PRESENCE: {\n    scopes: [GRAPH_SCOPES.PRESENCE_READ]\n  }\n};\n  \nexport const msalApp = new UserAgentApplication({\n  auth: {\n    clientId: \"66204339-daf1-40fa-aa31-57342272edce\",\n    authority: \"https://login.microsoftonline.com/common\",\n    validateAuthority: true,\n    postLogoutRedirectUri: \"https://luxafor-presence.azurewebsites.net\",\n    navigateToLoginRequestUrl: false\n  },\n  cache: {\n    cacheLocation: \"sessionStorage\",\n    storeAuthStateInCookie: isIE()\n  },\n  system: {\n    navigateFrameWait: 0,\n    logger: {\n      error: console.error,\n      errorPii: console.error,\n      info: console.log,\n      infoPii: console.log,\n      verbose: console.log,\n      verbosePii: console.log,\n      warning: console.warn,\n      warningPii: console.warn\n    }\n  }\n} as Configuration);","import React, { Component } from \"react\";\nimport {\n  msalApp,\n  requiresInteraction,\n  fetchMsGraph,\n  isIE,\n  GRAPH_ENDPOINTS,\n  GRAPH_REQUESTS\n} from \"../../constants\";\nimport { Presence } from \"../../models\";\nimport { AuthProviderProps, AuthProviderState } from '.';\n\n// If you support IE, our recommendation is that you sign-in using Redirect APIs\nconst useRedirectFlow = isIE();\n// const useRedirectFlow = true;\n\nexport default (C: any) => class AuthProvider extends Component<AuthProviderProps, AuthProviderState> {\n  private authCalled: boolean = false;\n  \n  constructor(props: AuthProviderProps) {\n    super(props);\n    \n    this.state = {\n      account: null,\n      error: null,\n      presence: null\n    };\n  }\n\n  /**\n   * componentDidMount lifecycle hook\n   */\n  public async componentDidMount() {\n    msalApp.handleRedirectCallback((error: any) => {\n      if (error) {\n        const errorMessage = error.errorMessage ? error.errorMessage : \"Unable to acquire access token.\";\n        // setState works as long as navigateToLoginRequestUrl: false\n        this.setState({\n          error: errorMessage\n        });\n      }\n    });\n    \n    const account = msalApp.getAccount();\n    \n    this.setState({\n      account\n    });\n  }\n  \n  /**\n   * Acquire token\n   * \n   * @param request \n   * @param redirect \n   */\n  public async acquireToken(request: any, redirect?: boolean) {\n    try {\n      return await msalApp.acquireTokenSilent(request);\n    } catch (error) {\n      // Call acquireTokenPopup (popup window) in case of acquireTokenSilent failure\n      // due to consent or interaction required ONLY\n      if (requiresInteraction(error.errorCode)) {\n        return redirect ? msalApp.acquireTokenRedirect(request) : msalApp.acquireTokenPopup(request);\n      } else {\n        console.error('Non-interactive error:', error.errorCode)\n      }\n    }\n  }\n  \n  /**\n   * Sign in the user\n   * \n   * @param redirect \n   */\n  public async onSignIn(redirect: boolean) {\n    if (this.authCalled) {\n      return;\n    }\n\n    this.authCalled = true;\n\n    if (redirect) {\n      return msalApp.loginRedirect(GRAPH_REQUESTS.PRESENCE);\n    }\n    \n    const loginResponse = await msalApp.loginPopup(GRAPH_REQUESTS.PRESENCE).catch(error => {\n      this.setState({\n        error: error.message\n      });\n    });\n\n    if (loginResponse) {\n      this.setState({\n        account: loginResponse.account,\n        error: null\n      });\n    }\n  }\n     \n  /**\n   * Sign out the user\n   */\n  public onSignOut() {\n    msalApp.logout();\n  }\n\n  \n\n  public getAccessToken(): string {\n    return \"\";\n  }\n      \n  /**\n   * Render the authentication component as a wrapper for the APP\n   */\n  render() {\n    return (\n      <C {...this.props}\n         account={this.state.account}\n         error={this.state.error}\n         presence={this.state.presence}\n         onSignIn={() => this.onSignIn(useRedirectFlow)}\n         onSignOut={() => this.onSignOut()}\n         acquireToken={this.acquireToken} />\n    );\n  }\n};","import { Availability } from \"../models\";\n\nexport const DEFAULT_COLOR = \"000000\";\nexport const API_URL = \"/api/setColor\";\n\nexport const KEY_DEVICE_ID = \"Device:ID\";\nexport const KEY_REFRESH_NR = \"RefreshNr\";\nexport const KEY_START_TIME = \"StartTime\";\nexport const KEY_END_TIME = \"EndTime\";\n\nexport class Luxafor {\n\n  public static async setColor(deviceId: string, presence: string): Promise<string> {\n    let color: string = DEFAULT_COLOR;\n\n    if (!deviceId || !presence) {\n      return color;\n    }\n    \n    switch(presence) {\n      case Availability.Available:\n      case Availability.AvailableIdle:\n        color = \"008000\";\n        break;\n      case Availability.Away:\n      case Availability.BeRightBack:\n        color = \"B2B200\";\n        break;\n      case Availability.Busy:\n      case Availability.BusyIdle:\n      case Availability.DoNotDisturb:\n        color = \"990000\";\n        break;\n      case Availability.Offline:\n      case Availability.PresenceUnknown:\n      default:\n        color = DEFAULT_COLOR;\n        break;\n    }\n\n    const body = {\n      userId: deviceId,\n      actionFields: {\n        color: \"custom\",\n        custom_color: color\n      }\n    };\n\n    const data = await fetch(API_URL, {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\",\n        \"accept\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    });\n\n    if (data && data.ok) {\n      return color;\n    } else {\n      return DEFAULT_COLOR;\n    }\n  }\n\n  public static getDeviceSetting<T>(name: string): T | string {\n    if (localStorage) {\n      return localStorage.getItem(`Luxafor:${name}`) || \"\";\n    }\n    return \"\";\n  }\n\n  public static setDeviceSetting(name: string, value: any): void {\n    if (localStorage) {\n      localStorage.setItem(`Luxafor:${name}`, value);\n    }\n  }\n}","import React, { useState } from 'react';\nimport { Luxafor, KEY_DEVICE_ID, KEY_REFRESH_NR, KEY_START_TIME, KEY_END_TIME, DEFAULT_COLOR } from \".\";\nimport { AppState } from \"../components/App\";\n\nexport const defaultContextValues = {\n  deviceId: Luxafor.getDeviceSetting<string>(KEY_DEVICE_ID),\n  refreshNr: Luxafor.getDeviceSetting<number>(KEY_REFRESH_NR) as number || 2,\n  startTime: Luxafor.getDeviceSetting<string>(KEY_START_TIME),\n  endTime: Luxafor.getDeviceSetting<string>(KEY_END_TIME),\n  presence: \"\",\n  overwrittenPresence: null,\n  color: DEFAULT_COLOR\n} as AppState;\n\nexport const PresenceContext = React.createContext(defaultContextValues);","import React, { useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Container from '@material-ui/core/Container';\nimport Grid from '@material-ui/core/Grid';\nimport { Account } from \"msal\";\nimport './Header.css';\nimport { PresenceContext } from '../../services/PresenceContext';\nimport { AppState } from '../App';\nimport { TimeType } from '../../models';\nimport { Theme, withStyles, WithStyles } from '@material-ui/core/styles';\n\nexport interface HeaderProps extends WithStyles<typeof styles> {\n  account: Account | null;\n\n  onSignIn: () => void;\n  onSignOut: () => void;\n  updateRefresh: (refreshNr: number) => void;\n  updateDeviceId: (deviceId: string) => void;\n  updateTime: (name: TimeType, time: string) => void;\n}\n\nexport interface HeaderState {\n  deviceId: string;\n}\n\nconst styles = (theme: Theme) => ({\n  grid: {\n    marginBottom: theme.spacing(1),\n    \"& > div\": {\n      width: \"80%\"\n    }\n  }\n});\n\n\nclass Header extends React.Component<HeaderProps, HeaderState> {\n  \n  constructor(props: HeaderProps) {\n    super(props);\n  }\n\n  private deviceChange = (newIdInput: React.ChangeEvent<HTMLInputElement>) => {\n    if (newIdInput && newIdInput.target && newIdInput.target.value) {\n      this.props.updateDeviceId(newIdInput.target.value);\n    }\n  };\n\n  private refreshChange = (newIdInput: React.ChangeEvent<HTMLInputElement>) => {\n    if (newIdInput && newIdInput.target && newIdInput.target.value) {\n      this.props.updateRefresh(parseInt(newIdInput.target.value));\n    }\n  };\n\n  public render(): React.ReactElement<HeaderProps> {\n\n    const { account, onSignIn, onSignOut, updateTime } = this.props;\n    const { deviceId, refreshNr, startTime, endTime } = this.context as AppState;\n\n    const { classes } = this.props;\n\n    return (\n      <header className=\"app__header\">\n        {\n        !account ? (\n          <Button onClick={onSignIn} variant=\"outlined\" color=\"primary\">Sign In</Button>\n        ) : (\n          <Container fixed>\n            <Grid container style={{flexGrow:1}} spacing={1}>\n              <Grid item xs={12}>\n                <Button onClick={onSignOut} variant=\"outlined\" color=\"secondary\">Sign Out: {account.userName}</Button>\n              </Grid>\n              <Grid className=\"app__header__inputs\" container>\n                <Grid item xs={12} sm={6} md={3} className={classes.grid}>\n                  <TextField label=\"Device ID\" \n                            variant=\"filled\" \n                            required\n                            value={deviceId}\n                            onChange={this.deviceChange} />\n                </Grid>\n                <Grid item xs={12} sm={6} md={3} className={classes.grid}>\n                  <TextField label=\"Refresh time (minutes)\" \n                            variant=\"filled\"\n                            value={refreshNr ? refreshNr : \"\"}\n                            type=\"number\"\n                            inputProps={{ min: \"1\", max: \"10\", step: \"1\" }}\n                            onChange={this.refreshChange} />\n                </Grid>\n                <Grid item xs={12} sm={6} md={3} className={classes.grid}>\n                  <TextField label=\"Start time\" \n                            variant=\"filled\"\n                            value={startTime}\n                            inputProps={{\n                              pattern: \"([01]?[0-9]|2[0-3]):[0-5][0-9]\"\n                            }}\n                            onChange={e => updateTime(TimeType.StartTime, e.target.value)} />\n                </Grid>\n                <Grid item xs={12} sm={6} md={3} className={classes.grid}>\n                  <TextField label=\"End time\" \n                            variant=\"filled\"\n                            value={endTime}\n                            inputProps={{\n                              pattern: \"([01]?[0-9]|2[0-3]):[0-5][0-9]\"\n                            }}\n                            onChange={e => updateTime(TimeType.EndTime, e.target.value)} />\n                </Grid>\n              </Grid>\n            </Grid>\n          </Container>\n        )}\n      </header>\n    );\n  }\n}\n\nHeader.contextType = PresenceContext;\n\nexport default withStyles(styles)(Header);","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport { Account } from \"msal\";\nimport './Footer.css';\nimport GitHub from '@material-ui/icons/GitHub';\nimport Copyright from '@material-ui/icons/Copyright';\n\nexport interface FooterProps {}\n\nexport const Footer = (props: FooterProps) => {\n  \n  return (\n    <footer className=\"app__footer\">\n      <Button href=\"https://www.eliostruyf.com\" title=\"Go to the website of Elio Struyf\">Copyright <Copyright /> Elio Struyf - https://www.eliostruyf.com</Button> - <Button href=\"https://github.com/estruyf\" className=\"app__footer_github\"><GitHub /></Button>\n    </footer>\n  );\n};","import React from 'react';\nimport { Account } from \"msal\";\nimport './LuxaforPresence.css';\nimport { PresenceContext } from '../../services/PresenceContext';\nimport { Availability } from '../../models';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { Button } from '@material-ui/core';\n\nexport interface LuxafoPresenceProps {\n  overwritePresense: (presense: string | null)  => void;\n}\n\nexport const LuxaforPresence = (props: LuxafoPresenceProps) => {\n\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    props.overwritePresense(event.target.value as string);\n  };\n  \n  return (\n    <PresenceContext.Consumer>\n      {\n        info => {\n          let color = `#282c34`;\n          switch (info.overwrittenPresence || info.presence) {\n            case Availability.Available:\n            case Availability.AvailableIdle:\n              color = `#58BC82`;\n              break;\n            case Availability.Busy:\n            case Availability.BusyIdle:\n            case Availability.DoNotDisturb:\n              color = `#6F1A07`;\n              break;\n            case Availability.Away:\n            case Availability.BeRightBack:\n              color = `#F6AE2D`;\n              break;\n            default: \n              color = `#282c34`;\n              break;\n          }\n\n          return (\n            <main className=\"app__main\" style={{\n              backgroundColor: `${color}`\n            }}>\n              <h1>Luxafor - Presence</h1>\n              {\n                (info.overwrittenPresence || info.presence) && (\n                  <>\n                    <Select value={info.overwrittenPresence || info.presence} onChange={handleChange} title=\"Manually select a presence status\">\n                      {\n                        Object.keys(Availability).map(key => (\n                          <MenuItem value={key}>{key}</MenuItem>\n                        ))\n                      }\n                    </Select>\n\n                    {\n                      info.overwrittenPresence && <Button className=\"app__main__reset\" variant=\"outlined\" color=\"secondary\" title=\"Reset the presence status. This will restart the automatic refresh.\" onClick={() => props.overwritePresense(null)}>Reset presence</Button>\n                    }\n                  </>\n                )\n              }\n            </main>\n          );\n        }\n      }\n    </PresenceContext.Consumer>\n  );\n};","\nexport const splitHours = (time: string): { hour: number, minutes: number} | null => {\n  if (time && time.includes(\":\")) {\n    const daySplit = time.split(\":\");\n    return {\n      hour: parseInt(daySplit[0]),\n      minutes: parseInt(daySplit[1])\n    }\n  }\n\n  return null;\n}","import React from 'react';\nimport './App.css';\nimport AuthProvider from '../Authenticator/AuthProvider';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport Header from '../Header/Header';\nimport { Footer } from '../Footer';\nimport { AppProps, AppState } from '.';\nimport { Luxafor, KEY_REFRESH_NR, KEY_DEVICE_ID } from '../../services';\nimport { LuxaforPresence } from '../LuxaforPresence';\nimport { defaultContextValues, PresenceContext } from '../../services/PresenceContext';\nimport { TimeType, Presence, Availability } from '../../models';\nimport { GRAPH_REQUESTS, fetchMsGraph, GRAPH_ENDPOINTS } from '../../constants';\nimport { splitHours } from '../../helpers/TimeHelpers';\n\n/**\n * TODO:\n * - Manual or automated work\n */\nconst theme = createMuiTheme({\n  palette: {\n    type: 'dark'\n  },\n  overrides: {\n    MuiSelect: {\n      select: {\n        fontSize: \"calc(10px + 2vmin)\"\n      }\n    }\n  }\n});\n\nclass App extends React.Component<AppProps, AppState> {\n  private refreshTimer: any;\n  \n  constructor(props: AppProps) {\n    super(props);\n\n    this.state = {\n      ...defaultContextValues\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.account && this.state.deviceId && this.state.refreshNr) {\n      this.startDataFetching();\n    }\n  }\n\n  componentDidUpdate(prevProps: AppProps, prevState: AppState) {\n    if (prevState.refreshNr !== this.state.refreshNr ||\n        prevState.startTime !== this.state.startTime ||\n        prevState.endTime !== this.state.endTime) {\n      this.startDataFetching();\n    }\n\n    if (prevProps.account !== this.props.account && this.props.account) {\n      this.startDataFetching();\n    }\n\n    if (!this.props.account) {\n      this.stopPresenceCheck();\n    }\n  }\n\n  private updateDeviceId = (deviceId: string): void => {\n    this.setState((prevState: AppState) => {\n      const cloned = {...prevState};\n      cloned.deviceId = deviceId;\n      Luxafor.setDeviceSetting(KEY_DEVICE_ID, deviceId);\n      return {\n        ...prevState,\n        deviceId\n      };\n    });\n  };\n\n  private updateRefresh = (refreshNr: number): void => {\n    this.setState((prevState: AppState) => {\n      Luxafor.setDeviceSetting(KEY_REFRESH_NR, refreshNr);\n      return {\n        ...prevState,\n        refreshNr\n      };\n    });\n  };\n\n  private updateTime = (name: TimeType, time: string) => {\n    if (name && time) {\n      Luxafor.setDeviceSetting(TimeType[name], time);\n      if (name === TimeType.StartTime) {\n        this.setState({\n          startTime: time\n        });\n      } else {\n        this.setState({\n          endTime: time\n        });\n      }\n    }\n  };\n\n  /**\n   * Start fetching the data\n   */\n  private startDataFetching() {\n    const { deviceId, startTime, endTime, refreshNr } = this.state;\n\n    const startTimeSplit = splitHours(startTime);\n    const endTimeSplit = splitHours(endTime);\n    const crntDate = new Date();\n    let statusMsg: string | null = null;\n    let statusColor: string | null = null;\n\n    if (startTimeSplit && (crntDate.getHours() < startTimeSplit.hour || crntDate.getHours() === startTimeSplit.hour && crntDate.getMinutes() < startTimeSplit.minutes)) {\n      statusMsg = Availability.Offline;\n      statusColor = \"000000\";\n    }\n\n    if (endTimeSplit && (crntDate.getHours() > endTimeSplit.hour || crntDate.getHours() === endTimeSplit.hour && crntDate.getMinutes() > endTimeSplit.minutes)) {\n      statusMsg = Availability.Offline;\n      statusColor = \"000000\";\n    }\n\n    let doCheck = true;\n    if (statusMsg) {\n      // Only update if needed\n      if (statusMsg !== this.state.presence) {\n        Luxafor.setColor(deviceId, Availability.Offline);\n        this.setState({\n          presence: statusMsg as string,\n          color: statusColor as string\n        });\n      }\n      doCheck = false;\n    }\n\n    if (doCheck) {\n      this.startPresenceCheck();\n    }\n\n    if (refreshNr) {\n      this.refreshTimer = setTimeout(() => {\n        this.startDataFetching();\n      }, refreshNr * 60 * 1000);\n    }\n  }\n\n  /**\n   * Start checking the user its presence\n   */\n  private startPresenceCheck = async () => {\n    const { acquireToken } = this.props;\n\n    try {\n      let token;\n\n      try {\n        token = await acquireToken(GRAPH_REQUESTS.PRESENCE);\n      } catch (error) {\n        this.setState({\n          error: error.message\n        });\n        return;\n      }\n\n      if (token) {\n        const presence: Presence = await fetchMsGraph(GRAPH_ENDPOINTS.PRESENCE, token.accessToken);\n        if (presence && presence.availability) {\n          const color = await Luxafor.setColor(this.state.deviceId, presence.availability);\n          this.setState({\n            presence: presence.availability,\n            color\n          });\n        }\n      }\n    } catch (error) {\n      this.setState({\n        error: \"Unable to fetch Graph profile.\"\n      });\n    }\n  }\n\n  private stopPresenceCheck() {\n    if (this.refreshTimer) {\n      clearTimeout(this.refreshTimer);\n      this.refreshTimer = null;\n    }\n  }\n\n  private overwritePresense = async (presence: string | null = null): Promise<void> => {\n    if (presence) {\n      debugger;\n      this.stopPresenceCheck();\n      const color = await Luxafor.setColor(this.state.deviceId, presence as string);\n      this.setState({\n        color\n      });\n    } else {\n      this.startDataFetching();\n    }\n\n    this.setState({\n      overwrittenPresence: presence\n    });\n  }\n\n  public render(): React.ReactElement<AppProps> {\n    return (\n      <PresenceContext.Provider value={{\n        ...this.state,\n        error: \"\"\n      }}>\n        <ThemeProvider theme={theme}>\n          <div className=\"app\">\n            <Header account={this.props.account}\n                    onSignIn={this.props.onSignIn} \n                    onSignOut={this.props.onSignOut}\n                    updateRefresh={this.updateRefresh}\n                    updateDeviceId={this.updateDeviceId}\n                    updateTime={this.updateTime} />\n  \n            <LuxaforPresence overwritePresense={this.overwritePresense} />\n\n            {\n              this.state.error && <p className=\"app__error\">{this.state.error}</p>\n            }\n  \n            <Footer />\n          </div>\n        </ThemeProvider>\n      </PresenceContext.Provider>\n    );\n  }\n}\n\nexport const AppWithAuth = AuthProvider(App);","export * from './App';\nexport * from './AppProps';\nexport * from './AppState';\n","export * from './Availability';\nexport * from './Presence';\nexport * from './TimeType';\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { AppWithAuth } from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<AppWithAuth />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}